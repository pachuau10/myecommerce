{% extends 'base.html' %}

{% block title %}Shop — Chhohreivung{% endblock %}

{% block content %}
<div class="container">
  <div class="page-hero">
    <h1 class="page-title">Shop</h1>
    <p class="page-subtitle">{{ products|length }} products available</p>
  </div>
</div>

<!-- Filter Bar -->
<div class="filter-bar">
  <div class="filter-inner">
    <form method="get" style="display: flex; gap: 16px; align-items: center; width: 100%;">
      <div class="filter-search">
        <svg class="filter-search-icon" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input type="text" name="q" value="{{ query }}" placeholder="Search products...">
      </div>

      <select name="category" class="filter-select" onchange="this.form.submit()">
        <option value="">All Categories</option>
        {% for cat in categories %}
        <option value="{{ cat.slug }}" {% if current_category == cat.slug %}selected{% endif %}>{{ cat.name }}</option>
        {% endfor %}
      </select>

      <select name="sort" class="filter-select" onchange="this.form.submit()">
        <option value="newest" {% if sort == 'newest' %}selected{% endif %}>Newest</option>
        <option value="price_asc" {% if sort == 'price_asc' %}selected{% endif %}>Price: Low to High</option>
        <option value="price_desc" {% if sort == 'price_desc' %}selected{% endif %}>Price: High to Low</option>
        <option value="name" {% if sort == 'name' %}selected{% endif %}>Name A–Z</option>
      </select>

      <input type="number" name="min_price" placeholder="Min $" class="filter-select" style="width: 90px;" value="{{ request.GET.min_price }}">
      <input type="number" name="max_price" placeholder="Max $" class="filter-select" style="width: 90px;" value="{{ request.GET.max_price }}">

      <button type="submit" class="btn btn-primary btn-sm">Filter</button>
      {% if query or current_category %}
      <a href="{% url 'store:product_list' %}" class="btn btn-ghost btn-sm">Clear</a>
      {% endif %}
    </form>
  </div>
</div>

<div class="container" style="padding-top: 48px; padding-bottom: 80px;">
  {% if products %}
    <div class="product-grid product-grid-4">
      {% for product in products %}
        {% include 'store/partials/product_card.html' with product=product %}
      {% endfor %}
    </div>
  {% else %}
    <div class="empty-state">
      <div class="empty-state-title">No products found</div>
      <p class="empty-state-text">Try adjusting your search or filters.</p>
      <a href="{% url 'store:product_list' %}" class="btn btn-primary">Browse All</a>
    </div>
  {% endif %}
</div>
{% endblock %}
